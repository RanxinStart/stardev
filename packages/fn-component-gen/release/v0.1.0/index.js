import{ref as w,createApp as F,getCurrentInstance as m}from"vue";const c=new Set;function b(e){c.has(e)||c.add(e)}function g(e){c.forEach(o=>{e.use(o)})}const t=new Map;function a(){const e=m()?.appContext.config.globalProperties.__popupKey;if(!e)throw new Error("usePopupVisible\u9700\u8981\u5728\u4F7F\u7528useFunctionComponent\u7684\u7EC4\u4EF6\u4E2D\u8C03\u7528");const o=t.get(e);if(!o)throw new Error("\u627E\u4E0D\u5230\u5BF9\u5E94\u7684popup\u5B9E\u4F8B");return o.visible}function E(){const e=m()?.appContext.config.globalProperties.__popupKey;if(!e)throw new Error("usePopupMethods\u9700\u8981\u5728\u4F7F\u7528useFunctionComponent\u7684\u7EC4\u4EF6\u4E2D\u8C03\u7528");const o=t.get(e);if(!o)throw new Error("\u627E\u4E0D\u5230\u5BF9\u5E94\u7684popup\u5B9E\u4F8B");return{confirm:o.confirm,close:o.close}}function C(){const e=a(),{confirm:o,close:n}=E();return{visible:e,confirm:o,close:n}}function v({component:e,props:o}){const n=w(!1),i=Symbol("popupKey");return new Promise((d,l)=>{const p=document.createElement("div");let u;t.set(i,{visible:n,close:s=>{l(s),r()},confirm:s=>{d(s),r()}}),u=F(e,o),u.config.globalProperties.__popupKey=i;function r(){n.value=!1,setTimeout(()=>{u?.unmount(),document.body.removeChild(p),u=void 0,t.delete(i)},1e3)}g(u),document.body.appendChild(p),u.mount(p),setTimeout(()=>{n.value=!0});function f(){l("back"),r(),window.removeEventListener("popstate",f)}window.addEventListener("popstate",f)})}export{b as setPlugin,v as useFunctionComponent,C as usePopupAll,E as usePopupMethods,a as usePopupVisible};
//# sourceMappingURL=index.js.map
